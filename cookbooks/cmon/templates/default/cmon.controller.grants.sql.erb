SET SQL_LOG_BIN=0;
GRANT INSERT,UPDATE,DELETE,SELECT ON cmon.* TO 'cmon'@'127.0.0.1' IDENTIFIED BY '<%= node['cmon_password'] %>' WITH GRANT OPTION;
GRANT INSERT,UPDATE,DELETE,SELECT ON cmon.* TO 'cmon'@'<%= node['controller']['mysql_hostname'] %>' IDENTIFIED BY '<%= node['cmon_password'] %>' WITH GRANT OPTION;
GRANT PROCESS, SUPER on *.* TO 'cmon'@'127.0.0.1' IDENTIFIED BY '<%= node['cmon_password'] %>';
GRANT PROCESS, SUPER on *.* TO 'cmon'@'<%= node['controller']['mysql_hostname'] %>' IDENTIFIED BY '<%= node['cmon_password'] %>';
USE cmon;
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'OS','<%= node['platform'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CLUSTER_NAME','<%= node['cluster_name'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'WWWROOT','<%= node['misc']['wwwroot'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CMON_HOSTNAME','<%= node['controller']['mysql_hostname'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CMON_HOSTNAME1','<%= node['controller']['mysql_hostname'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CMON_PASSWORD','<%= node['cmon_password'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'COREDIR','<%= node['misc']['core_dir'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'SSH_USER','<%= node['misc']['os_user'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'SSH_IDENTITY', '<%= node['misc']['IDENTITY'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'BACKUPDIR','<%= node['misc']['BACKUPDIR'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'BACKUP_RETENTION','0');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'STAGING_DIR','/tmp');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'PURGE','7');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'LOG_COLLECTION','30');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'MYSQL_PORT','<%= node['controller']['mysql_port'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'BINDIR','<%= node['cmon_mysql']['bindir'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'ROOT_PASSWORD','<%= node['cmon_mysql']['root_password'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'REPL_PASSWORD','<%= node['cmon_mysql']['repl_password'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'REPL_USER','<%= node['cmon_mysql']['repl_user'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'NDB_CONNECTSTRING','<%= node['controller']['ndb_connectstring'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'NDB_BINARY','<%= node['cmon_mysql']['ndb_bin_dir'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'SCRIPTDIR','<%= node['cmon_mysql']['script_dir'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'PRE_INSTALLED_IMAGE',0);
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'INSTALL_METHOD','TGZ');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'OS_USER_HOME','<%= ENV['HOME'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CONFIGDIR','<%= node['install_config_path'] %>');
INSERT IGNORE INTO cmon.cmon_sw_package (cid, packageid, name,rpm,selected) VALUES (1,1,'CMON_DEFAULT',0,1);
INSERT IGNORE INTO cmon.cmon_sw_package (cid, packageid, name,rpm,selected) VALUES (1,2,'MYSQL_INITIAL_DEPLOY',0,1);
