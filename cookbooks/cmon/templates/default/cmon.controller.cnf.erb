#
# Generated by Chef for <%= node['ipaddress'] %>
#
# Local modifications will be overwritten.
#
# Controller cmon.cnf
#

# id and name of cluster that this cmon controller. 
# Must be unique for each monitored cluster, like server-id in mysql
cluster_id=<%= node['cluster_id'] %>
name=<%= node['cluster_name'] %>

# mode = [controller|agent|dual]
mode=<%= node['mode']['controller'] %>

# type = [mysqlcluster|replication|galera]
type=<%= node['cluster_type'] %>

# os = [redhat|debian]
<% case node['platform'] -%>
<% when 'centos', 'redhat', 'fedora', 'suse', 'scientific', 'amazon' -%>
os=redhat
<% else -%>
os=debian
<% end -%>

# skip_name_resolve = [0|1] - set 1 if you use ip addresses only everywhere
skip_name_resolve=1

## CMON DB config  - mysql_password is for the 'cmon' user
#mysql_basedir=<%= node['cmon_mysql']['basedir'] %>
mysql_port=<%= node['controller']['mysql_port'] %>
#mysql_hostname=<%= node['controller']['mysql_hostname'] %>
mysql_hostname=127.0.0.1
mysql_password=<%= node['controller']['mysql_password'] %>
# ndb_connectstring  - comma-separated list of management servers: a:1186,b:1196
ndb_connectstring=<%= node['controller']['ndb_connectstring'] %>

#cmon_multi_tenant=no
#cmon_preinstalled_image=no
#cmon_db=cmon

## Agent to local DB connection - local_mysql_password is for the 'cmon' user
local_mysql_password=<%= node['agent']['mysql_password'] %>
local_mysql_hostname=<%= node['agent']['mysql_hostname'] %>
local_mysql_port=<%= node['agent']['mysql_port'] %>

#hostname is the hostname of the current host
hostname=<%= node['ipaddress'] %>

## The user that can SSH without password to the other nodes
os_user=<%= node['misc']['os_user'] %>

#location of Configurator script root, e.g /root/mysqlcluster-71/
cmon_core_dir=<%= node['misc']['core_dir'] %>

# location of cmon.pid file. The pidfile is written in /tmp/ by default
pidfile=<%= node['misc']['pid_file'] %>

# logfile is default to syslog.
logfile=<%= node['misc']['log_file'] %>

# daemonize = 0, not daemoize = 1
nodaemon=<%= node['misc']['nodaemon'] %>

# collection intervals (in seconds)
db_stats_collection_interval=<%= node['misc']['db_stats_collection_interval'] %>
host_stats_collection_interval=<%= node['misc']['host_stats_collection_interval'] %>

wwwroot=<%= node['misc']['wwwroot'] %>

# mysql servers in the cluster. "," or " " sep. list
mysql_server_addresses=
# mgm and data nodes are only used to MySQL Cluster "," or " " sep. list
datanode_addresses=
mgmnode_addresses=

###### LEGACY RRD SECTION - graphs ######
mysql_bindir=<%= node['cmon_mysql']['bindir'] %>
imagedir=<%= node['rrd']['imagedir'] %>
rrdtool=<%= node['rrd']['rrdtool'] %>
rrd_datadir=<%= node['rrd']['datadir'] %>
###### END OF RRD SECTION - graphs ######

